{"version":3,"sources":["/source/datatables_renderers.coffee","datatables_renderers.min.js"],"names":["callWithJQuery","hasProp","hasOwnProperty","pivotModule","exports","module","require","define","amd","jQuery","$","pivotUtilities","datatables_renderers","Datatable","pivotData","opts","aggregator","c","colAttrs","colKey","colKeys","defaults","i","j","r","result","rowAttrs","rowKey","rowKeys","spanSize","tbody","td","tfoot","th","thead","totalAggregator","tr","txt","val","x","localeStrings","totals","extend","getRowKeys","getColKeys","document","createElement","className","arr","k","l","len","noDraw","ref","ref1","stop","length","call","parseInt","setAttribute","appendChild","innerHTML","getAggregator","value","format","this"],"mappings":"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","file":"datatables_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery\n        \ncallWithJQuery ($) ->\n\n    $.pivotUtilities.datatables_renderers = \"Datatable\": (pivotData, opts) ->\n        defaults =\n            localeStrings:\n                totals: \"Totals\"\n\n        opts = $.extend defaults, opts\n\n        colAttrs = pivotData.colAttrs\n        rowAttrs = pivotData.rowAttrs\n        rowKeys = pivotData.getRowKeys()\n        colKeys = pivotData.getColKeys()\n\n        #now actually build the output\n        result = document.createElement(\"table\")\n        result.className = \"pvtTable\"\n        thead = document.createElement(\"thead\");\n        tbody = document.createElement(\"tbody\");\n        tfoot = document.createElement(\"tfoot\");\n\n        #helper function for setting row/col-span in pivotTableRenderer\n        spanSize = (arr, i, j) ->\n            if i != 0\n                noDraw = true\n                for x in [0..j]\n                    if arr[i-1][x] != arr[i][x]\n                        noDraw = false\n                if noDraw\n                  return -1 #do not draw cell\n            len = 0\n            while i+len < arr.length\n                stop = false\n                for x in [0..j]\n                    stop = true if arr[i][x] != arr[i+len][x]\n                break if stop\n                len++\n            return len\n\n        #the first few rows are for col headers\n        for own j, c of colAttrs\n            tr = document.createElement(\"tr\")\n            if parseInt(j) == 0 and rowAttrs.length != 0\n                th = document.createElement(\"th\")\n                th.setAttribute(\"colspan\", rowAttrs.length)\n                th.setAttribute(\"rowspan\", colAttrs.length)\n                tr.appendChild th\n            th = document.createElement(\"th\")\n            th.className = \"pvtAxisLabel\"\n            th.innerHTML = c\n            tr.appendChild th\n            for own i, colKey of colKeys\n                x = spanSize(colKeys, parseInt(i), parseInt(j))\n                if x != -1\n                    th = document.createElement(\"th\")\n                    th.className = \"pvtColLabel\"\n                    th.innerHTML = colKey[j]\n                    th.setAttribute(\"colspan\", x)\n                    if parseInt(j) == colAttrs.length-1 and rowAttrs.length != 0\n                        th.setAttribute(\"rowspan\", 2)\n                    tr.appendChild th\n            if parseInt(j) == 0\n                th = document.createElement(\"th\")\n                th.className = \"pvtTotalLabel\"\n                th.innerHTML = opts.localeStrings.totals\n                th.setAttribute(\"rowspan\", colAttrs.length + (if rowAttrs.length ==0 then 0 else 1))\n                tr.appendChild th\n            thead.appendChild tr\n\n        #then a row for row header headers\n        if rowAttrs.length !=0\n            tr = document.createElement(\"tr\")\n            for own i, r of rowAttrs\n                th = document.createElement(\"th\")\n                th.className = \"pvtAxisLabel\"\n                th.innerHTML = r\n                tr.appendChild th \n            th = document.createElement(\"th\")\n            if colAttrs.length ==0\n                th.className = \"pvtTotalLabel\"\n                th.innerHTML = opts.localeStrings.totals\n            tr.appendChild th\n            thead.appendChild tr\n\n        #now the actual data rows, with their row headers and totals\n        for own i, rowKey of rowKeys\n            tr = document.createElement(\"tr\")\n            for own j, txt of rowKey\n                th = document.createElement('th')\n                th.className = 'pvtRowLabel'\n                th.innerHTML = txt\n                tr.appendChild th\n                if parseInt(j) == rowAttrs.length-1 and colAttrs.length !=0\n                    tr.appendChild document.createElement('th')\n            for own j, colKey of colKeys #this is the tight loop\n                aggregator = pivotData.getAggregator(rowKey, colKey)\n                val = aggregator.value()\n                td = document.createElement(\"td\")\n                td.className = \"pvtVal row#{i} col#{j}\"\n                td.innerHTML = aggregator.format(val)\n                td.setAttribute(\"data-value\", val)\n                tr.appendChild td\n\n            totalAggregator = pivotData.getAggregator(rowKey, [])\n            val = totalAggregator.value()\n            td = document.createElement(\"td\")\n            td.className = \"pvtTotal rowTotal\"\n            td.innerHTML = totalAggregator.format(val)\n            td.setAttribute(\"data-value\", val)\n            td.setAttribute(\"data-for\", \"row\"+i)\n            tr.appendChild td\n            tbody.appendChild tr\n\n        #finally, the row for col totals, and a grand total\n        tr = document.createElement(\"tr\")\n        th = document.createElement(\"th\")\n        th.className = \"pvtTotalLabel\"\n        th.innerHTML = opts.localeStrings.totals\n        th.setAttribute(\"colspan\", rowAttrs.length + (if colAttrs.length == 0 then 0 else 1))\n        tr.appendChild th\n        for own j, colKey of colKeys\n            totalAggregator = pivotData.getAggregator([], colKey)\n            val = totalAggregator.value()\n            td = document.createElement(\"td\")\n            td.className = \"pvtTotal colTotal\"\n            td.innerHTML = totalAggregator.format(val)\n            td.setAttribute(\"data-value\", val)\n            td.setAttribute(\"data-for\", \"col\"+j)\n            tr.appendChild td\n        totalAggregator = pivotData.getAggregator([], [])\n        val = totalAggregator.value()\n        td = document.createElement('td')\n        td.className = 'pvtGrandTotal'\n        td.innerHTML = totalAggregator.format(val)\n        td.setAttribute(\"data-value\", val)\n        tr.appendChild td\n        result.appendChild thead\n        result.appendChild tbody\n        tfoot.appendChild tr\n        result.appendChild tfoot\n\n        #squirrel this away for later\n        result.setAttribute(\"data-numrows\", rowKeys.length)\n        result.setAttribute(\"data-numcols\", colKeys.length)\n\n        return result\n    \n","(function(){var e,t={}.hasOwnProperty;(e=function(e){return\"object\"==typeof exports&&\"object\"==typeof module?e(require(\"jquery\")):\"function\"==typeof define&&define.amd?define([\"jquery\"],e):e(jQuery)})(function(e){return e.pivotUtilities.datatables_renderers={Datatable:function(a,n){var l,r,o,d,c,i,s,p,m,u,h,g,f,b,v,A,C,E,T,L,N,w,H,M;i={localeStrings:{totals:\"Totals\"}},n=e.extend(i,n),o=a.colAttrs,h=a.rowAttrs,f=a.getRowKeys(),c=a.getColKeys(),u=document.createElement(\"table\"),u.className=\"pvtTable\",T=document.createElement(\"thead\"),v=document.createElement(\"tbody\"),C=document.createElement(\"tfoot\"),b=function(e,t,a){var n,l,r,o,d,c,i,s;if(0!==t){for(o=!0,s=n=0,d=a;d>=0?d>=n:n>=d;s=d>=0?++n:--n)e[t-1][s]!==e[t][s]&&(o=!1);if(o)return-1}for(r=0;t+r<e.length;){for(i=!1,s=l=0,c=a;c>=0?c>=l:l>=c;s=c>=0?++l:--l)e[t][s]!==e[t+r][s]&&(i=!0);if(i)break;r++}return r};for(p in o)if(t.call(o,p)){r=o[p],N=document.createElement(\"tr\"),0===parseInt(p)&&0!==h.length&&(E=document.createElement(\"th\"),E.setAttribute(\"colspan\",h.length),E.setAttribute(\"rowspan\",o.length),N.appendChild(E)),E=document.createElement(\"th\"),E.className=\"pvtAxisLabel\",E.innerHTML=r,N.appendChild(E);for(s in c)t.call(c,s)&&(d=c[s],M=b(c,parseInt(s),parseInt(p)),-1!==M&&(E=document.createElement(\"th\"),E.className=\"pvtColLabel\",E.innerHTML=d[p],E.setAttribute(\"colspan\",M),parseInt(p)===o.length-1&&0!==h.length&&E.setAttribute(\"rowspan\",2),N.appendChild(E)));0===parseInt(p)&&(E=document.createElement(\"th\"),E.className=\"pvtTotalLabel\",E.innerHTML=n.localeStrings.totals,E.setAttribute(\"rowspan\",o.length+(0===h.length?0:1)),N.appendChild(E)),T.appendChild(N)}if(0!==h.length){N=document.createElement(\"tr\");for(s in h)t.call(h,s)&&(m=h[s],E=document.createElement(\"th\"),E.className=\"pvtAxisLabel\",E.innerHTML=m,N.appendChild(E));E=document.createElement(\"th\"),0===o.length&&(E.className=\"pvtTotalLabel\",E.innerHTML=n.localeStrings.totals),N.appendChild(E),T.appendChild(N)}for(s in f)if(t.call(f,s)){g=f[s],N=document.createElement(\"tr\");for(p in g)t.call(g,p)&&(w=g[p],E=document.createElement(\"th\"),E.className=\"pvtRowLabel\",E.innerHTML=w,N.appendChild(E),parseInt(p)===h.length-1&&0!==o.length&&N.appendChild(document.createElement(\"th\")));for(p in c)t.call(c,p)&&(d=c[p],l=a.getAggregator(g,d),H=l.value(),A=document.createElement(\"td\"),A.className=\"pvtVal row\"+s+\" col\"+p,A.innerHTML=l.format(H),A.setAttribute(\"data-value\",H),N.appendChild(A));L=a.getAggregator(g,[]),H=L.value(),A=document.createElement(\"td\"),A.className=\"pvtTotal rowTotal\",A.innerHTML=L.format(H),A.setAttribute(\"data-value\",H),A.setAttribute(\"data-for\",\"row\"+s),N.appendChild(A),v.appendChild(N)}N=document.createElement(\"tr\"),E=document.createElement(\"th\"),E.className=\"pvtTotalLabel\",E.innerHTML=n.localeStrings.totals,E.setAttribute(\"colspan\",h.length+(0===o.length?0:1)),N.appendChild(E);for(p in c)t.call(c,p)&&(d=c[p],L=a.getAggregator([],d),H=L.value(),A=document.createElement(\"td\"),A.className=\"pvtTotal colTotal\",A.innerHTML=L.format(H),A.setAttribute(\"data-value\",H),A.setAttribute(\"data-for\",\"col\"+p),N.appendChild(A));return L=a.getAggregator([],[]),H=L.value(),A=document.createElement(\"td\"),A.className=\"pvtGrandTotal\",A.innerHTML=L.format(H),A.setAttribute(\"data-value\",H),N.appendChild(A),u.appendChild(T),u.appendChild(v),C.appendChild(N),u.appendChild(C),u.setAttribute(\"data-numrows\",f.length),u.setAttribute(\"data-numcols\",c.length),u}}})}).call(this);\n//# sourceMappingURL=datatables_renderers.min.js.map"],"sourceRoot":"/source/"}